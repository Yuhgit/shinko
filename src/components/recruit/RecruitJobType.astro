---
/**
 * 仕事を知るセクション（Figma 320:6141 準拠）
 * Job Type ラベル・見出し・グラデーションキャッチ・職種タブ（施工管理職 / 現場技能職）
 * スタイルは Tailwind CSS で記述
 */
import { recruitJobTypeSection } from "./recruit-data";
---

<section
  id="job"
  class="recruit-job-type w-full md:pt-[80px] lg:pt-[120px] bg-recruit-grid bg-grid-24"
  aria-labelledby="recruit-job-type-heading"
>
  <!-- 上部：白＋グリッド背景・キャッチ・説明 -->
  <div
    class="recruit-job-type__intro py-8 sm:py-10 md:py-14 px-[var(--recruit-container-px)] text-center"
  >
    <div class="recruit-container mb-16">
      <span
        class="recruit-job-type__en-label block font-roboto text-lg font-normal text-main-orange tracking-wider pb-2 mb-2 relative after:content-[''] after:block after:w-6 after:h-px after:bg-main-orange after:mt-2 after:absolute after:left-[50%] after:translate-x-[-50%] after:bottom-0"
      >
        {recruitJobTypeSection.enLabel}
      </span>
      <h2
        id="recruit-job-type-heading"
        class="recruit-job-type__heading font-noto-sans text-xl sm:text-2xl md:text-3xl font-bold text-main-orange leading-tight mb-8"
      >
        {recruitJobTypeSection.heading}
      </h2>
      <div class="recruit-job-type__headline my-0 mb-8 text-center md:text-left space-y-1">
        <span
          class="recruit-job-type__headline-line1 block w-fit px-4 mb-4 bg-recruit-gradient-orange font-noto-sans text-3xl mx-auto md:mx-0 sm:text-[6.6vw] font-bold text-white leading-snug tracking-wide"
        >
          誰<span class="text-[5.5vw]">でも</span>成長<span class="text-[5.5vw]">できる</span>環境<span class="text-[5.5vw]">が、</span>
        </span>
        <span
          class="recruit-job-type__headline-line2 block w-fit px-4 bg-recruit-gradient-orange font-noto-sans text-3xl sm:text-[6.6vw] font-bold text-white leading-snug tracking-wide  mx-auto md:mx-0"
        >
          ここにある<span class="text-[5.5vw]">。</span>
        </span>
      </div>
      <p
        class="recruit-job-type__desc max-w-[42rem] font-noto-sans text-base font-normal leading-7 text-text-black text-left m-0 whitespace-pre-line"
      >
        {recruitJobTypeSection.description}
      </p>
    </div>

  <!-- メイン：濃いオレンジの角丸コンテナ・縦書き Job Type・仕事内容・タブ＋パネル -->
  <div
      class="recruit-job-type__content-label inline-block pt-4 pb-2 px-6 bg-main-orange text-white font-noto-sans text-base md:text-xl rounded-t-lg"
    >
      {recruitJobTypeSection.contentLabel}
  </div>
  <div
    class="recruit-job-type__main relative w-full py-12 md:py-16 px-[var(--recruit-container-px)] bg-main-orange rounded-2xl overflow-hidden"
  >
    <span
      class="recruit-job-type__side-label absolute left-0 top-[120px] translate-x-[-40%] rotate-90 font-roboto text-[64px] font-medium text-white opacity-20 whitespace-nowrap pointer-events-none tracking-widest hidden md:block"
      aria-hidden="true"
    >
      {recruitJobTypeSection.enLabel}
    </span> 
    <span
      class="recruit-job-type__side-label absolute right-0 bottom-[120px] translate-x-[40%] rotate-90 font-roboto text-[64px] font-medium text-white opacity-20 whitespace-nowrap pointer-events-none tracking-widest hidden md:block"
      aria-hidden="true"
    >
      {recruitJobTypeSection.enLabel}
    </span>

    <div class="recruit-container recruit-job-type__inner relative z-10">
      <h3
        class="recruit-job-type__main-heading font-noto-sans text-xl sm:text-4xl font-bold text-white leading-snug mb-12 tracking-widest"
      >
        {recruitJobTypeSection.mainHeading}
      </h3>
      <div
        class="recruit-job-type__tabs flex flex-nowrap gap-0 mb-6 overflow-x-auto bg-gray-100 rounded-xl w-[300px] md:w-[400px] py-1 px-1 mx-auto"
        role="tablist"
        aria-label="職種"
      >
        {
          recruitJobTypeSection.tabs.map((tab, index) => (
            <button
              type="button"
              role="tab"
              id={`recruit-job-tab-${tab.id}`}
              aria-selected={index === 0}
              aria-controls={`recruit-job-panel-${tab.id}`}
              data-job-tab-index={index}
              data-active={index === 0}
              class="recruit-job-type__trigger w-[150px] md:w-[200px] py-3.5 font-noto-sans text-base md:text-2xl font-bold rounded-xl cursor-pointer transition-colors duration-200 bg-gray-100 text-gray-600 data-[active=true]:bg-white data-[active=true]:text-main-orange data-[active=true]:relative data-[active=true]:z-10"
            >
              {tab.label}
            </button>
          ))
        }
      </div>

      <div class="recruit-job-type__panels bg-white rounded-xl py-10 px-[5.5vw]">
        <!-- 施工管理職 -->
        <div
          role="tabpanel"
          id="recruit-job-panel-sekoukanri"
          aria-labelledby="recruit-job-tab-sekoukanri"
          class="recruit-job-type__panel pt-2"
          data-job-panel="sekoukanri"
        >
          <p
            class="recruit-job-type__panel-subheading font-noto-sans text-lg md:text-2xl font-bold text-main-orange mb-4 m-0"
          >
            {recruitJobTypeSection.sekoukanri.subheading}
          </p>
          <h4
            class="recruit-job-type__panel-title inline-block font-noto-sans text-lg md:text-4xl font-bold text-white rounded bg-main-orange py-3 px-6 mb-4 tracking-wider"
          >
            {recruitJobTypeSection.sekoukanri.title}
          </h4>
          <p
            class="recruit-job-type__panel-lead font-noto-sans text-base font-normal mb-6"
          >
            {recruitJobTypeSection.sekoukanri.lead}
          </p>
          <div
            class="recruit-job-type__images grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6"
          >
            {
              recruitJobTypeSection.sekoukanri.images.map((src) => (
                <img
                  src={src}
                  alt=""
                  class="recruit-job-type__img w-full aspect-[16/10] object-cover rounded-lg"
                  width="400"
                  height="250"
                  loading="lazy"
                />
              ))
            }
          </div>
          <div
            class="recruit-job-type__cards grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"
          >
            {
              recruitJobTypeSection.sekoukanri.cards.map((card) => (
                <div
                  class="recruit-job-type-card p-5 bg-[#FFF3ED] rounded-lg"
                >
                  {card.icon ? (
                    <img
                      src={card.icon}
                      alt=""
                      width="40"
                      height="40"
                      class="recruit-job-type-card__icon block w-10 h-10 mb-3 object-contain opacity-95 mx-auto"
                      aria-hidden="true"
                    />
                  ) : (
                    <span
                      class="recruit-job-type-card__icon block w-10 h-10 mb-3 bg-main-orange rounded-full opacity-95 mx-auto"
                      aria-hidden="true"
                    ></span>
                  )}
                  <h5
                    class="recruit-job-type-card__title font-noto-sans text-lg md:text-xl font-bold text-main-orange mb-2"
                  >
                    {card.title}
                  </h5>
                  <p
                    class="recruit-job-type-card__desc font-noto-sans font-normal leading-relaxed"
                  >
                    {card.desc}
                  </p>
                </div>
              ))
            }
          </div>
        </div>
        <!-- 現場技能職 -->
        <div
          role="tabpanel"
          id="recruit-job-panel-genbashinou"
          aria-labelledby="recruit-job-tab-genbashinou"
          class="recruit-job-type__panel pt-2"
          data-job-panel="genbashinou"
          hidden
        >
          <p
            class="recruit-job-type__panel-subheading font-noto-sans text-lg md:text-2xl font-bold text-main-orange mb-4 m-0"
          >
            {recruitJobTypeSection.genbashinou.subheading}
          </p>
          <h4
            class="recruit-job-type__panel-title inline-block font-noto-sans text-lg md:text-4xl font-bold text-white rounded bg-main-orange py-3 px-6 mb-4 tracking-wider"
          >
            {recruitJobTypeSection.genbashinou.title}
          </h4>
          <p
            class="recruit-job-type__panel-lead font-noto-sans text-base font-normal mb-6 whitespace-pre-line"
          >
            {recruitJobTypeSection.genbashinou.lead}
          </p>
          <div
            class="recruit-job-type__images grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6"
          >
            {
              recruitJobTypeSection.genbashinou.images.map((src) => (
                <img
                  src={src}
                  alt=""
                  class="recruit-job-type__img w-full aspect-[16/10] object-cover rounded-lg"
                  width="400"
                  height="250"
                  loading="lazy"
                />
              ))
            }
          </div>
          <div
            class="recruit-job-type__cards grid grid-cols-1 sm:grid-cols-2 gap-4"
          >
            {
              recruitJobTypeSection.genbashinou.cards.map((card) => (
                <div
                  class="recruit-job-type-card p-5 bg-[#FFF3ED] rounded-lg"
                >
                  {card.icon ? (
                    <img
                      src={card.icon}
                      alt=""
                      width="40"
                      height="40"
                      class="recruit-job-type-card__icon block w-10 h-10 mb-3 object-contain opacity-95 mx-auto"
                      aria-hidden="true"
                    />
                  ) : (
                    <span
                      class="recruit-job-type-card__icon block w-10 h-10 mb-3 bg-main-orange rounded-full opacity-95 mx-auto"
                      aria-hidden="true"
                    ></span>
                  )}
                  <h5
                    class="recruit-job-type-card__title font-noto-sans text-lg md:text-xl font-bold text-main-orange mb-2"
                  >
                    {card.title}
                  </h5>
                  <p
                    class="recruit-job-type-card__desc font-noto-sans font-normal leading-relaxed"
                  >
                    {card.desc}
                  </p>
                </div>
              ))
            }
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>
</section>

<style>
  /* タブパネル非表示（hidden 属性と併用） */
  .recruit-job-type__panel[hidden] {
    display: none !important;
  }
</style>

<script>
  const section = document.querySelector(".recruit-job-type");
  if (!section) throw new Error("recruit-job-type not found");

  const triggers = section.querySelectorAll<HTMLButtonElement>('[role="tab"]');
  const panels = section.querySelectorAll<HTMLElement>('[role="tabpanel"]');

  function switchJobTab(activeIndex: number) {
    triggers.forEach((t, i) => {
      const selected = i === activeIndex;
      t.setAttribute("aria-selected", String(selected));
      t.setAttribute("data-active", String(selected));
    });
    panels.forEach((p, i) => {
      (p as HTMLElement).hidden = i !== activeIndex;
    });
  }

  triggers.forEach((trigger, index) => {
    trigger.addEventListener("click", () => switchJobTab(index));
  });
</script>
